(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 10.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     70004,       1863]
NotebookOptionsPosition[     66296,       1736]
NotebookOutlinePosition[     66631,       1751]
CellTagsIndexPosition[     66588,       1748]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["3-local Ising Optimisation using Simulated Annealing", "Title",
 CellChangeTimes->{{3.671883320156126*^9, 3.671883352322755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"TestHamiltonian", "=", 
   RowBox[{"RandomHamiltonian", "[", 
    RowBox[{"5", ",", "0", ",", "0"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.671970008082614*^9, 3.6719700184101048`*^9}, {
  3.671970063145505*^9, 3.6719700855119047`*^9}, {3.671970220918388*^9, 
  3.671970222000408*^9}, {3.672035784058432*^9, 3.6720358753374023`*^9}, {
  3.672035973780134*^9, 3.672035974075563*^9}, {3.672036009952227*^9, 
  3.672036010070435*^9}, {3.6720378653719177`*^9, 3.6720378663551617`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"TestHamiltonian", ",", 
      RowBox[{"Constraints", "[", "11", "]"}]}], "}"}], ",", 
    RowBox[{"SpinVariables", "[", "11", "]"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6718826689868717`*^9, 3.67188270336012*^9}, {
  3.671882739376601*^9, 3.671882741727841*^9}, {3.6718831665891647`*^9, 
  3.671883170365301*^9}, {3.671893489262978*^9, 3.671893490239697*^9}, {
  3.6719538245529222`*^9, 3.671953824744253*^9}, {3.671965180053615*^9, 
  3.671965241387808*^9}, {3.671965376459806*^9, 3.671965379057498*^9}, {
  3.671970025043397*^9, 3.671970089496612*^9}, {3.671970225009074*^9, 
  3.6719702276569*^9}, {3.672035794666061*^9, 3.672035879680254*^9}, {
  3.672035941878817*^9, 3.67203594473201*^9}, {3.672035976244772*^9, 
  3.672035978740828*^9}, {3.672036014729072*^9, 3.672036017419724*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"33.887707`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "31.61533631537595`"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s11", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.671965241768462*^9, 3.671965264931744*^9}, 
   3.6719653796254063`*^9, 3.671969997814308*^9, {3.671970057490117*^9, 
   3.671970073190419*^9}, {3.6720357807696753`*^9, 3.6720358654743547`*^9}, 
   3.672035909090928*^9, 3.672035948006075*^9, 3.672035992648161*^9, 
   3.672036051662166*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Timing", "[", 
  RowBox[{"NMinimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"TestHamiltonian", ",", 
      RowBox[{"Constraints", "[", "5", "]"}]}], "}"}], " ", ",", 
    RowBox[{"SpinVariables", "[", "5", "]"}], ",", 
    RowBox[{"Method", "\[Rule]", " ", "\"\<SimulatedAnnealing\>\""}]}], "]"}],
   "]"}]], "Input",
 CellChangeTimes->{{3.671882364936372*^9, 3.671882404506249*^9}, {
  3.671882454074746*^9, 3.671882464617998*^9}, {3.6718825135216093`*^9, 
  3.671882545961504*^9}, {3.671882589955127*^9, 3.671882593601088*^9}, {
  3.671882649024961*^9, 3.67188266024163*^9}, {3.671882745448306*^9, 
  3.671882748351694*^9}, {3.67188317588577*^9, 3.67188317626899*^9}, {
  3.671893512167439*^9, 3.671893512624041*^9}, {3.671953830672608*^9, 
  3.671953830863309*^9}, {3.671965186916153*^9, 3.671965234987194*^9}, {
  3.671965383299693*^9, 3.671965386409609*^9}, {3.6719700315079517`*^9, 
  3.6719700349453983`*^9}, {3.6719700758986263`*^9, 3.671970079080152*^9}, {
  3.671970229545642*^9, 3.671970232160511*^9}, {3.672035799809376*^9, 
  3.67203586078791*^9}, {3.672035910808329*^9, 3.6720359139256983`*^9}, {
  3.672035954126837*^9, 3.672036023083284*^9}, {3.67203786907561*^9, 
  3.672037871538478*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"0.078368`", ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", "4.277137794880337`"}], ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6718825158875723`*^9, 3.671882547009861*^9}, {
   3.671882594206959*^9, 3.671882610405517*^9}, {3.671882656277821*^9, 
   3.6718826606142607`*^9}, {3.671882752032724*^9, 3.671882776704369*^9}, {
   3.671883172881279*^9, 3.671883176603848*^9}, 3.67189351310034*^9, 
   3.671952880039817*^9, 3.671952954797175*^9, 3.6719538347780724`*^9, {
   3.671953886654457*^9, 3.671953903370491*^9}, 3.671965208446207*^9, {
   3.671965242910408*^9, 3.671965285944737*^9}, {3.6719653868820868`*^9, 
   3.671965395628669*^9}, {3.671969998876437*^9, 3.671970002502367*^9}, {
   3.671970059346908*^9, 3.671970079538142*^9}, 3.6719703596174393`*^9, {
   3.672035802815174*^9, 3.672035867659587*^9}, 3.672035917250197*^9, 
   3.672035960184807*^9, 3.672036004339122*^9, 3.672036103524777*^9, 
   3.672037872018639*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Constraint generating function", "Subsection",
 CellChangeTimes->{{3.67195988925001*^9, 3.6719598944684134`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "Generate", " ", "arbitrary", " ", "constraints", " ", "for", " ", "n", 
     " ", "spins", " ", "saying", " ", "that", " ", "each", " ", "one", " ", 
     "must", " ", "either", " ", "be"}], " ", "+", 
    RowBox[{"1", " ", "or"}], " ", "-", "1"}], "*)"}], "\[IndentingNewLine]", 
  
  RowBox[{
   RowBox[{
    RowBox[{"Constraint", "[", "index_", "]"}], ":=", 
    RowBox[{"\"\<(s\>\"", "<>", 
     RowBox[{"ToString", "[", "index", "]"}], " ", "<>", "\"\<==1||s\>\"", "<>", 
     RowBox[{"ToString", "[", "index", "]"}], "<>", "\"\<==-1)&&\>\""}]}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Constraints", "[", "spins_", "]"}], ":=", 
    RowBox[{"ToExpression", "[", 
     RowBox[{"StringDrop", "[", 
      RowBox[{
       RowBox[{"StringJoin", "[", 
        RowBox[{"Array", "[", 
         RowBox[{"Constraint", ",", "spins"}], "]"}], "]"}], ",", 
       RowBox[{"-", "2"}]}], "]"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.671952266203898*^9, 3.6719522812853622`*^9}, {
  3.6719523160182343`*^9, 3.671952328522236*^9}, {3.6719524766412697`*^9, 
  3.671952492913639*^9}, {3.671952570735876*^9, 3.671952625864438*^9}, {
  3.671952767911675*^9, 3.6719528238230753`*^9}, {3.671953023785872*^9, 
  3.671953150988944*^9}, {3.671953284196995*^9, 3.6719532894275703`*^9}, {
  3.6719533788434753`*^9, 3.671953378987805*^9}, {3.671953457066656*^9, 
  3.671953466635079*^9}, {3.671959900403103*^9, 3.671959951689769*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Example", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"Constraints", "[", "5", "]"}]}]], "Input",
 CellChangeTimes->{{3.671959914110627*^9, 3.671959923563696*^9}, {
  3.671959955186884*^9, 3.671959963647955*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s1", "\[Equal]", "1"}], "||", 
    RowBox[{"s1", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s2", "\[Equal]", "1"}], "||", 
    RowBox[{"s2", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s3", "\[Equal]", "1"}], "||", 
    RowBox[{"s3", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s4", "\[Equal]", "1"}], "||", 
    RowBox[{"s4", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ")"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"s5", "\[Equal]", "1"}], "||", 
    RowBox[{"s5", "\[Equal]", 
     RowBox[{"-", "1"}]}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.6719599647186947`*^9, 3.672035746026309*^9, 
  3.672046034397109*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Arbitrary 3-local Hamiltonian generating function", "Subsection",
 CellChangeTimes->{{3.6719600000085897`*^9, 3.671960027286318*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Useful", " ", "function", " ", "to", " ", "generate", " ", "si", " ", 
    "Mathematica", " ", "expression"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Spin", "[", "index_", "]"}], ":=", 
   RowBox[{"ToExpression", "[", 
    RowBox[{"\"\<s\>\"", "<>", 
     RowBox[{"ToString", "[", "index", "]"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6719649790970097`*^9, 3.671964994995964*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Generate", " ", "a", " ", "set", " ", "of", " ", "random", " ", "local", 
   " ", 
   RowBox[{"fields", ".", " ", "The"}], " ", "sparseness", " ", "parameter", 
   " ", "controls", " ", "the", " ", "probability", " ", "of", " ", "a", " ", 
   "local", " ", "field", " ", "being", " ", "zero"}], "*)"}]], "Input",
 CellChangeTimes->{{3.671961877731056*^9, 3.6719619042168837`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"LocalField", "[", 
   RowBox[{"spin_", ",", "sparseness_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ">", "sparseness"}], ",", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1"}], ",", "1"}], "}"}], ",", 
       RowBox[{"WorkingPrecision", "\[Rule]", "3"}]}], "]"}], "*", 
     RowBox[{"Spin", "[", "spin", "]"}]}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"LocalFields", "[", 
   RowBox[{"spins_", ",", "sparseness_"}], "]"}], ":=", 
  RowBox[{"Sum", "[", 
   RowBox[{
    RowBox[{"LocalField", "[", 
     RowBox[{"i", ",", "sparseness"}], "]"}], ",", 
    RowBox[{"{", 
     RowBox[{"i", ",", "1", ",", "spins"}], "}"}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.671960337685956*^9, 3.671960355236844*^9}, {
  3.671960411328597*^9, 3.671960505839283*^9}, {3.671960772194544*^9, 
  3.671960774586233*^9}, {3.67196172401147*^9, 3.671961725667293*^9}, {
  3.67196179721131*^9, 3.671961808852261*^9}, {3.67196465987182*^9, 
  3.671964660214211*^9}, {3.671964924494042*^9, 3.671964948596161*^9}, {
  3.671968372988139*^9, 3.671968376405937*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Example", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"LocalFields", "[", 
   RowBox[{"10", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6719618127158337`*^9, 3.671961834601592*^9}, {
  3.671961911418659*^9, 3.671961916025475*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.560546875`3.", " ", "s1"}], "+", 
  RowBox[{"0.158203125`3.", " ", "s10"}], "+", 
  RowBox[{"0.927734375`3.", " ", "s2"}], "-", 
  RowBox[{"0.21875`3.", " ", "s3"}], "-", 
  RowBox[{"0.71875`3.", " ", "s4"}], "-", 
  RowBox[{"0.458984375`3.", " ", "s5"}], "-", 
  RowBox[{"0.556640625`3.", " ", "s6"}], "+", 
  RowBox[{"0.640625`3.", " ", "s7"}], "-", 
  RowBox[{"0.080078125`3.", " ", "s8"}], "-", 
  RowBox[{"0.708984375`3.", " ", "s9"}]}]], "Output",
 CellChangeTimes->{{3.671961816037434*^9, 3.671961835051703*^9}, {
   3.671964959388727*^9, 3.6719649615397663`*^9}, 3.6720357512848797`*^9, 
   3.672046034862328*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
  "Functions", " ", "to", " ", "generate", " ", "a", " ", "random", " ", 
   "set", " ", "of", " ", "coupling", " ", "terms", " ", "for", " ", "n", " ", 
   RowBox[{"spins", ".", " ", "The"}], " ", "sparseness", " ", "parameter", 
   " ", "controls", " ", "the", " ", "probability", " ", "of", " ", "a", " ", 
   "coupling", " ", "being", " ", "zero"}], "*)"}]], "Input",
 CellChangeTimes->{{3.671964502624571*^9, 3.671964517401205*^9}, {
  3.671964566599401*^9, 3.671964606502902*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"CouplingTerm", "[", 
   RowBox[{"i_", ",", "combinations_", ",", "sparseness_"}], "]"}], ":=", 
  RowBox[{"If", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"RandomReal", "[", "]"}], ">", "sparseness"}], ",", 
    RowBox[{
     RowBox[{"RandomReal", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"-", "1"}], ",", "1"}], "}"}], "]"}], "*", 
     RowBox[{
      RowBox[{"combinations", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "1", "]"}], "]"}], "*", 
     RowBox[{
      RowBox[{"combinations", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "2", "]"}], "]"}], "*", 
     RowBox[{
      RowBox[{"combinations", "[", 
       RowBox[{"[", "i", "]"}], "]"}], "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", "0"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"CouplingTerms", "[", 
   RowBox[{"spins_", ",", "sparseness_"}], "]"}], ":=", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", "combinations", "}"}], ",", 
    RowBox[{
     RowBox[{"combinations", "=", 
      RowBox[{"Subsets", "[", 
       RowBox[{
        RowBox[{"Array", "[", 
         RowBox[{"Spin", ",", "spins"}], "]"}], ",", 
        RowBox[{"{", "3", "}"}]}], "]"}]}], ";", 
     RowBox[{"Sum", "[", 
      RowBox[{
       RowBox[{"CouplingTerm", "[", 
        RowBox[{"i", ",", "combinations", ",", "sparseness"}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Binomial", "[", 
          RowBox[{"spins", ",", "3"}], "]"}]}], "}"}]}], "]"}]}]}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.6719640374101048`*^9, 3.6719640630562887`*^9}, {
  3.671964233282735*^9, 3.671964265825595*^9}, {3.671964350042944*^9, 
  3.67196437679235*^9}, {3.6719644444406977`*^9, 3.671964444550273*^9}, {
  3.67196464420821*^9, 3.671964654209654*^9}, {3.671964964821282*^9, 
  3.671964972573797*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Example", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"CouplingTerms", "[", 
   RowBox[{"6", ",", "0"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.671964196205698*^9, 3.6719642166880217`*^9}, {
  3.671964287273799*^9, 3.67196432038439*^9}, {3.67196446053668*^9, 
  3.671964460687986*^9}, {3.6719646120562973`*^9, 3.67196461591111*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "0.010092869328689247`"}], " ", "s1", " ", "s2", " ", "s3"}], 
  "-", 
  RowBox[{"0.29135342672972264`", " ", "s1", " ", "s2", " ", "s4"}], "-", 
  RowBox[{"0.40530478735882225`", " ", "s1", " ", "s3", " ", "s4"}], "-", 
  RowBox[{"0.4499085908460465`", " ", "s2", " ", "s3", " ", "s4"}], "-", 
  RowBox[{"0.8351883646581593`", " ", "s1", " ", "s2", " ", "s5"}], "+", 
  RowBox[{"0.6357224413595906`", " ", "s1", " ", "s3", " ", "s5"}], "-", 
  RowBox[{"0.8058968884329771`", " ", "s2", " ", "s3", " ", "s5"}], "-", 
  RowBox[{"0.9175947088381355`", " ", "s1", " ", "s4", " ", "s5"}], "+", 
  RowBox[{"0.6129246126045369`", " ", "s2", " ", "s4", " ", "s5"}], "+", 
  RowBox[{"0.9316538105186551`", " ", "s3", " ", "s4", " ", "s5"}], "-", 
  RowBox[{"0.7619882688417223`", " ", "s1", " ", "s2", " ", "s6"}], "-", 
  RowBox[{"0.3492288313244458`", " ", "s1", " ", "s3", " ", "s6"}], "+", 
  RowBox[{"0.1727080881938723`", " ", "s2", " ", "s3", " ", "s6"}], "+", 
  RowBox[{"0.5344932703833627`", " ", "s1", " ", "s4", " ", "s6"}], "-", 
  RowBox[{"0.9966276734018882`", " ", "s2", " ", "s4", " ", "s6"}], "-", 
  RowBox[{"0.8403860649622721`", " ", "s3", " ", "s4", " ", "s6"}], "+", 
  RowBox[{"0.7744142040957511`", " ", "s1", " ", "s5", " ", "s6"}], "+", 
  RowBox[{"0.458950043245407`", " ", "s2", " ", "s5", " ", "s6"}], "+", 
  RowBox[{"0.7227411127337096`", " ", "s3", " ", "s5", " ", "s6"}], "+", 
  RowBox[{
  "0.9620971013391362`", " ", "s4", " ", "s5", " ", "s6"}]}]], "Output",
 CellChangeTimes->{{3.671964199951627*^9, 3.6719642170446453`*^9}, {
   3.671964289468554*^9, 3.6719643208057632`*^9}, {3.6719644582829723`*^9, 
   3.671964461199521*^9}, 3.6719646173661203`*^9, 3.672035751358951*^9, 
   3.672046035101276*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Combine", " ", "the", " ", "above", " ", "functions", " ", "into", " ", 
    "one", " ", "which", " ", "generates", " ", "an", " ", "arbitrary", " ", 
    "Hamiltonian", " ", "for", " ", "n", " ", 
    RowBox[{"spins", ".", " ", "The"}], " ", "sparseness", " ", "parameters", 
    " ", "control", " ", "the", " ", "probability", " ", "of", " ", "a", " ", 
    "local", " ", "field", " ", "or", " ", "coupling", " ", "being", " ", 
    "zero"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"RandomHamiltonian", "[", 
    RowBox[{"spins_", ",", "localSparseness_", ",", "couplingSparseness_"}], 
    "]"}], ":=", 
   RowBox[{
    RowBox[{"LocalFields", "[", 
     RowBox[{"spins", ",", "localSparseness"}], "]"}], "+", 
    RowBox[{"CouplingTerms", "[", 
     RowBox[{"spins", ",", "couplingSparseness"}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.671965003044277*^9, 3.671965079491297*^9}, {
  3.6719651138043137`*^9, 3.67196515631598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RandomHamiltonian", "[", 
  RowBox[{"3", ",", "0", ",", "0"}], "]"}]], "Input",
 CellChangeTimes->{{3.67196508219177*^9, 3.671965094047634*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.375`3.", " ", "s1"}], "-", 
  RowBox[{"0.67578125`3.", " ", "s2"}], "-", 
  RowBox[{"0.419921875`3.", " ", "s3"}], "-", 
  RowBox[{
  "0.24035563397812432`", " ", "s1", " ", "s2", " ", "s3"}]}]], "Output",
 CellChangeTimes->{{3.6719650893416557`*^9, 3.671965094351798*^9}, 
   3.672035751412924*^9, 3.672046035258999*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Spin Variable Generating Function", "Subsection",
 CellChangeTimes->{{3.671965303847093*^9, 3.67196530772151*^9}, {
  3.6719653699777327`*^9, 3.67196537058582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SpinVariables", "[", "spins_", "]"}], ":=", 
  RowBox[{"Array", "[", 
   RowBox[{"Spin", ",", "spins"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6719653197007093`*^9, 3.671965356441822*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"SpinVariables", "[", "10", "]"}]], "Input",
 CellChangeTimes->{{3.671965361484673*^9, 3.671965364817101*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "s1", ",", "s2", ",", "s3", ",", "s4", ",", "s5", ",", "s6", ",", "s7", ",",
    "s8", ",", "s9", ",", "s10"}], "}"}]], "Output",
 CellChangeTimes->{3.6719653651662683`*^9, 3.672035759442634*^9, 
  3.672046035582348*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Turn our (classical) Hamiltonian function into a matrix", "Subsection",
 CellChangeTimes->{{3.671966308106545*^9, 3.671966328330995*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
   "Function", " ", "to", " ", "turn", " ", "the", " ", "generated", " ", 
    "local", " ", "fields", " ", "into", " ", "a", " ", "matrix"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"LocalFieldMatrix", "[", 
     RowBox[{"hamiltonianF_", ",", "spins_", ",", "spin_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"matrix", ",", "list", ",", "h"}], "}"}], ",", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"list", "=", 
          RowBox[{"List", "@@", "hamiltonianF"}]}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{
            RowBox[{"StringTake", "[", 
             RowBox[{
              RowBox[{"ToString", "[", 
               RowBox[{"list", "[", 
                RowBox[{"[", "spin", "]"}], "]"}], "]"}], ",", "1"}], "]"}], 
            "\[Equal]", "\"\<-\>\""}], ",", 
           RowBox[{"h", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "spin", "]"}], "]"}], "]"}], ",", "6"}], "]"}], 
             "]"}]}], ",", 
           RowBox[{"h", "=", 
            RowBox[{"ToExpression", "[", 
             RowBox[{"StringTake", "[", 
              RowBox[{
               RowBox[{"ToString", "[", 
                RowBox[{"list", "[", 
                 RowBox[{"[", "spin", "]"}], "]"}], "]"}], ",", "5"}], "]"}], 
             "]"}]}]}], "]"}], ",", 
         RowBox[{"If", "[", 
          RowBox[{
           RowBox[{"spin", "\[Equal]", "1"}], ",", 
           RowBox[{"matrix", "=", 
            RowBox[{"h", "*", "pauliZ"}]}], ",", 
           RowBox[{"matrix", "=", 
            RowBox[{"IdentityMatrix", "[", "2", "]"}]}]}], "]"}]}], "}"}], 
       ";", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Do", "[", 
          RowBox[{
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{"spin", "\[Equal]", "i"}], ",", 
             RowBox[{"matrix", "=", 
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{"matrix", ",", 
                RowBox[{"h", "*", "pauliZ"}]}], "]"}]}], ",", 
             RowBox[{"matrix", "=", 
              RowBox[{"KroneckerProduct", "[", 
               RowBox[{"matrix", ",", 
                RowBox[{"IdentityMatrix", "[", "2", "]"}]}], "]"}]}]}], "]"}],
            ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "2", ",", "spins"}], "}"}]}], "]"}], ",", 
         "matrix"}], "}"}]}]}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LocalFieldsMatrix", "[", 
     RowBox[{"hamiltonianF_", ",", "spins_"}], "]"}], ":=", 
    RowBox[{"Sum", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"FunctionToMatrix", "[", 
        RowBox[{"hamiltonianF", ",", "spins", ",", "i"}], "]"}], "[", 
       RowBox[{"[", "2", "]"}], "]"}], ",", 
      RowBox[{"{", 
       RowBox[{"i", ",", "1", ",", "spins"}], "}"}]}], "]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.6719697997410183`*^9, 3.671969813237295*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "Example", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"Fields", "=", 
    RowBox[{"LocalFields", "[", 
     RowBox[{"3", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"LocalFieldsMatrix", "[", 
     RowBox[{"Fields", ",", "3"}], "]"}], "//", "MatrixForm"}]}]}]], "Input",
 CellChangeTimes->{{3.6719698162609463`*^9, 3.671969904513702*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"0.7265625`3.", " ", "s1"}], "-", 
  RowBox[{"0.1953125`3.", " ", "s2"}], "+", 
  RowBox[{"0.826171875`3.", " ", "s3"}]}]], "Output",
 CellChangeTimes->{{3.671969832473793*^9, 3.671969905621117*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.358`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "0.29399999999999993`"}], "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`"},
     {"0.`", "0.`", "1.7479999999999998`", "0.`", "0.`", "0.`", "0.`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0.09599999999999997`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "0.09599999999999997`"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.7479999999999998`"}], "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.29399999999999993`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.358`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.671969832473793*^9, 3.6719699056262283`*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Test timing of Minimize and NMinimize", "Subsection",
 CellChangeTimes->{{3.672036106602488*^9, 3.672036124722329*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"TestHamiltonian", "=", 
   RowBox[{"RandomHamiltonian", "[", 
    RowBox[{"5", ",", "0", ",", "0"}], "]"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "Minimize", " ", "solves", " ", "the", " ", "problem", " ", "exactly"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Minimize", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"TestHamiltonian", ",", 
      RowBox[{"Constraints", "[", "5", "]"}]}], "}"}], ",", 
    RowBox[{"SpinVariables", "[", "5", "]"}]}], "]"}], "\[IndentingNewLine]", 
  
  RowBox[{"(*", 
   RowBox[{
    RowBox[{
    "NMinimize", " ", "attempts", " ", "to", " ", "solve", " ", "the", " ", 
     "problem", " ", "with", " ", "some", " ", "probabilistic", " ", 
     "algorithm"}], ",", " ", 
    RowBox[{
    "in", " ", "this", " ", "case", " ", "Simulated", " ", "Annealing"}]}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{"NMinimize", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"TestHamiltonian", ",", 
     RowBox[{"Constraints", "[", "5", "]"}]}], "}"}], " ", ",", 
   RowBox[{"SpinVariables", "[", "5", "]"}], ",", 
   RowBox[{"Method", "\[Rule]", " ", "\"\<SimulatedAnnealing\>\""}]}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.672039036022461*^9, 3.672039088790348*^9}, {
  3.672039148434496*^9, 3.6720391510332613`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6.517965990171781`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
     RowBox[{"s2", "\[Rule]", 
      RowBox[{"-", "1.`"}]}], ",", 
     RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
     RowBox[{"s4", "\[Rule]", 
      RowBox[{"-", "1.`"}]}], ",", 
     RowBox[{"s5", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.672039133630143*^9, 3.672039151577971*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "6.517965990171781`"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
     RowBox[{"s2", "\[Rule]", 
      RowBox[{"-", "1.`"}]}], ",", 
     RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
     RowBox[{"s4", "\[Rule]", 
      RowBox[{"-", "1.`"}]}], ",", 
     RowBox[{"s5", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.672039133630143*^9, 3.6720391516493473`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"timesExact", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solnsExact", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energiesExact", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"timesAnneal", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solnsAnneal", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energiesAnneal", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testHamiltonian", ",", "tempTimeExact", ",", "tempTimeAnneal", ",", 
       "tempSolnExact", ",", "tempSolnAnneal", ",", "tempEnergyExact", ",", 
       "tempEnergyAnneal"}], "}"}], ",", 
     RowBox[{
      RowBox[{"testHamiltonian", "=", 
       RowBox[{"RandomHamiltonian", "[", 
        RowBox[{"i", ",", "0", ",", "0"}], "]"}]}], ";", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tempTimeExact", ",", 
           RowBox[{"{", 
            RowBox[{"tempEnergyExact", ",", "tempSolnExact"}], "}"}]}], "}"}],
          "=", 
         RowBox[{"Timing", "[", 
          RowBox[{"Minimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"testHamiltonian", ",", 
              RowBox[{"Constraints", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"SpinVariables", "[", "i", "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tempTimeAnneal", ",", 
           RowBox[{"{", 
            RowBox[{"tempEnergyAnneal", ",", "tempSolnAnneal"}], "}"}]}], 
          "}"}], "=", 
         RowBox[{"Timing", "[", 
          RowBox[{"NMinimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"testHamiltonian", ",", 
              RowBox[{"Constraints", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"SpinVariables", "[", "i", "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"timesExact", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"timesExact", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempTimeExact"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"timesAnneal", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"timesAnneal", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempTimeAnneal"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"solnsExact", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"solnsExact", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempSolnExact"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"solnsAnneal", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"solnsAnneal", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempSolnAnneal"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"energiesExact", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"energiesExact", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempEnergyExact"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"energiesAnneal", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"energiesAnneal", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempEnergyAnneal"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          "\"\< Spin Run Complete\>\""}], "]"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "3", ",", "12"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6720361503033752`*^9, 3.672036164579129*^9}, {
  3.672036255634268*^9, 3.6720362777938643`*^9}, {3.6720365017176867`*^9, 
  3.672036503443307*^9}, {3.672036761307516*^9, 3.672036809778503*^9}, {
  3.672037308119301*^9, 3.672037329504176*^9}, {3.6720374646950617`*^9, 
  3.672037595790494*^9}, {3.67203790050076*^9, 3.672037905812092*^9}, {
  3.672037959255233*^9, 3.67203796491765*^9}, {3.672038045579402*^9, 
  3.6720380507233686`*^9}, {3.6720381285473948`*^9, 3.672038159146552*^9}, {
  3.6720383245618877`*^9, 3.672038363822537*^9}, {3.672038729647315*^9, 
  3.672038729990581*^9}, {3.672038956191984*^9, 3.672039009527462*^9}, {
  3.672039213524021*^9, 3.672039213698572*^9}, {3.6720460438921757`*^9, 
  3.672046044635318*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"3 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.6720460471278133`*^9}],

Cell[BoxData["\<\"4 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.672046047212977*^9}],

Cell[BoxData["\<\"5 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.6720460473647137`*^9}],

Cell[BoxData["\<\"6 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.672046047741376*^9}],

Cell[BoxData["\<\"7 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.672046048590321*^9}],

Cell[BoxData["\<\"8 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.672046050680916*^9}],

Cell[BoxData["\<\"9 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.67204605658785*^9}],

Cell[BoxData["\<\"10 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.672046077424098*^9}],

Cell[BoxData["\<\"11 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.6720461484151506`*^9}],

Cell[BoxData["\<\"12 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.6720392517380123`*^9, 3.6720464199341297`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"timesExact", "\[IndentingNewLine]", "solnsExact", "\
\[IndentingNewLine]", "energiesExact"}], "Input",
 CellChangeTimes->{{3.67203796891047*^9, 3.672037992454632*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.043038`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0.055877`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.087378`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0.196667`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "0.444824`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "1.027751`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "2.95132`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10.664899`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "34.347117`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "133.616557`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6720379707199087`*^9, 3.672038010630188*^9}, 
   3.6720380587496777`*^9, 3.672038161903017*^9, 3.672038355414466*^9, 
   3.67203839695068*^9, 3.6720390978809767`*^9, 3.672040949252228*^9, 
   3.672046577879125*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s8", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s11", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s11", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s12", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6720379707199087`*^9, 3.672038010630188*^9}, 
   3.6720380587496777`*^9, 3.672038161903017*^9, 3.672038355414466*^9, 
   3.67203839695068*^9, 3.6720390978809767`*^9, 3.672040949252228*^9, 
   3.6720465778886557`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2.151672055356363`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "3.1393080523208754`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"-", "3.0113043425701864`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"-", "6.748451136290174`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"-", "8.612514288569669`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"-", "13.482455929868532`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"-", "19.02328663732288`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"-", "21.929357701592533`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"-", "37.631001276862484`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"-", "34.131553759976235`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6720379707199087`*^9, 3.672038010630188*^9}, 
   3.6720380587496777`*^9, 3.672038161903017*^9, 3.672038355414466*^9, 
   3.67203839695068*^9, 3.6720390978809767`*^9, 3.672040949252228*^9, 
   3.672046577892762*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"timesAnneal", "\[IndentingNewLine]", "solnsAnneal", "\
\[IndentingNewLine]", "energiesAnneal"}], "Input",
 CellChangeTimes->{{3.6720380002266407`*^9, 3.672038008498522*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.016974`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0.041436`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.073923`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "0.196814`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", "0.403067`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", "1.038563`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", "2.956864`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", "10.165459`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "36.620724`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", "138.037007`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.672038012422559*^9, 3.672038358094206*^9, 
  3.672038399657188*^9, 3.672039103338192*^9, 3.672040952433571*^9, 
  3.6720465798069563`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s8", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s7", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s11", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s5", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s6", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s7", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s8", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s9", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s10", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s11", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s12", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.672038012422559*^9, 3.672038358094206*^9, 
  3.672038399657188*^9, 3.672039103338192*^9, 3.672040952433571*^9, 
  3.6720465798114862`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2.151672055356363`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "3.1393080523208754`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"-", "3.0113043425701864`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", 
     RowBox[{"-", "6.748451136290174`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"7", ",", 
     RowBox[{"-", "8.612514288569669`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"8", ",", 
     RowBox[{"-", "13.482455929868532`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"9", ",", 
     RowBox[{"-", "19.02328663732288`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"10", ",", 
     RowBox[{"-", "21.929357701592533`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", 
     RowBox[{"-", "37.631001276862484`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"12", ",", 
     RowBox[{"-", "34.131553759976235`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.672038012422559*^9, 3.672038358094206*^9, 
  3.672038399657188*^9, 3.672039103338192*^9, 3.672040952433571*^9, 
  3.672046579814909*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ListLinePlot", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"timesExact", ",", "timesAnneal"}], "}"}], ",", 
   RowBox[{"PlotRange", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"2", ",", "13"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"0", ",", "140"}], "}"}]}], "}"}]}], ",", 
   RowBox[{"AxesLabel", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Spins\>\"", ",", "\"\<Time [s]\>\""}], "}"}]}], ",", 
   RowBox[{"PlotLegends", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"\"\<Exact\>\"", ",", "\"\<Simulated Annealing\>\""}], "}"}]}]}],
   "]"}]], "Input",
 CellChangeTimes->{{3.672038027640209*^9, 3.672038031441416*^9}, {
  3.672038166641272*^9, 3.672038178769537*^9}, {3.672038254040457*^9, 
  3.6720383112718973`*^9}, {3.6720384051042957`*^9, 3.672038422887896*^9}, {
  3.672038739817464*^9, 3.6720387400091867`*^9}, {3.6720393001253366`*^9, 
  3.672039367292532*^9}, {3.672040294022809*^9, 3.6720403045745077`*^9}, {
  3.672040966175641*^9, 3.6720409677259073`*^9}, {3.672041006519368*^9, 
  3.672041021774716*^9}, {3.672046592408063*^9, 3.672046593079571*^9}}],

Cell[BoxData[
 TemplateBox[{GraphicsBox[{{}, {{{}, {}, {
        Hue[0.67, 0.6, 0.6], 
        Directive[
         PointSize[0.019444444444444445`], 
         RGBColor[0.368417, 0.506779, 0.709798], 
         AbsoluteThickness[1.6]], 
        LineBox[{{3., 0.043038}, {4., 0.055877}, {5., 0.087378}, {6., 
         0.196667}, {7., 0.444824}, {8., 1.027751}, {9., 2.95132}, {10., 
         10.664899}, {11., 34.347117}, {12., 133.616557}}]}, {
        Hue[0.9060679774997897, 0.6, 0.6], 
        Directive[
         PointSize[0.019444444444444445`], 
         RGBColor[0.880722, 0.611041, 0.142051], 
         AbsoluteThickness[1.6]], 
        LineBox[{{3., 0.016974}, {4., 0.041436}, {5., 0.073923}, {6., 
         0.196814}, {7., 0.403067}, {8., 1.038563}, {9., 2.956864}, {10., 
         10.165459}, {11., 36.620724}, {12., 138.037007}}]}}}, {}}, {
    DisplayFunction -> Identity, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     AxesOrigin -> {2.055, 0}, PlotRange -> {{2, 13}, {0, 140}}, 
     DisplayFunction -> Identity, AspectRatio -> 
     NCache[GoldenRatio^(-1), 0.6180339887498948], Axes -> {True, True}, 
     AxesLabel -> {
       FormBox["\"Spins\"", TraditionalForm], 
       FormBox["\"Time [s]\"", TraditionalForm]}, AxesOrigin -> {2.055, 0}, 
     DisplayFunction :> Identity, Frame -> {{False, False}, {False, False}}, 
     FrameLabel -> {{None, None}, {None, None}}, 
     FrameTicks -> {{Automatic, Automatic}, {Automatic, Automatic}}, 
     GridLines -> {None, None}, GridLinesStyle -> Directive[
       GrayLevel[0.5, 0.4]], Method -> {}, PlotRange -> {{2, 13}, {0, 140}}, 
     PlotRangeClipping -> True, PlotRangePadding -> {{0, 0}, {0, 0}}, 
     Ticks -> {Automatic, Automatic}}],FormBox[
    FormBox[
     TemplateBox[{"\"Exact\"", "\"Simulated Annealing\""}, "LineLegend", 
      DisplayFunction -> (FormBox[
        StyleBox[
         StyleBox[
          PaneBox[
           TagBox[
            GridBox[{{
               TagBox[
                GridBox[{{
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                   GraphicsBox[{{
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[
                    Directive[
                    Opacity[0.3], 
                    GrayLevel[0]]], 
                    PointSize[0.35], 
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    AbsoluteThickness[1.6]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> Automatic, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}}, 
                 GridBoxAlignment -> {
                  "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                 AutoDelete -> False, 
                 GridBoxDividers -> {
                  "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                 GridBoxItemSize -> {"Columns" -> {{All}}, "Rows" -> {{All}}},
                  GridBoxSpacings -> {
                  "Columns" -> {{0.5}}, "Rows" -> {{0.8}}}], "Grid"]}}, 
             GridBoxAlignment -> {"Columns" -> {{Left}}, "Rows" -> {{Top}}}, 
             AutoDelete -> False, 
             GridBoxItemSize -> {
              "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
             GridBoxSpacings -> {"Columns" -> {{1}}, "Rows" -> {{0}}}], 
            "Grid"], Alignment -> Left, AppearanceElements -> None, 
           ImageMargins -> {{5, 5}, {5, 5}}, ImageSizeAction -> 
           "ResizeToFit"], LineIndent -> 0, StripOnInput -> False], {
         FontFamily -> "Arial"}, Background -> Automatic, StripOnInput -> 
         False], TraditionalForm]& ), 
      InterpretationFunction :> (RowBox[{"LineLegend", "[", 
         RowBox[{
           RowBox[{"{", 
             RowBox[{
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.368417, 0.506779, 0.709798], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.24561133333333335`, 0.3378526666666667, 
                    0.4731986666666667], FrameTicks -> None, PlotRangePadding -> 
                    None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.368417, 0.506779, 0.709798]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.368417, 0.506779, 0.709798]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.368417, 0.506779, 0.709798], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}], 
               ",", 
               RowBox[{"Directive", "[", 
                 RowBox[{
                   RowBox[{"PointSize", "[", "0.019444444444444445`", "]"}], 
                   ",", 
                   InterpretationBox[
                    ButtonBox[
                    TooltipBox[
                    GraphicsBox[{{
                    GrayLevel[0], 
                    RectangleBox[{0, 0}]}, {
                    GrayLevel[0], 
                    RectangleBox[{1, -1}]}, {
                    RGBColor[0.880722, 0.611041, 0.142051], 
                    RectangleBox[{0, -1}, {2, 1}]}}, AspectRatio -> 1, Frame -> 
                    True, FrameStyle -> 
                    RGBColor[
                    0.587148, 0.40736066666666665`, 0.09470066666666668], 
                    FrameTicks -> None, PlotRangePadding -> None, ImageSize -> 
                    Dynamic[{
                    Automatic, 1.35 CurrentValue["FontCapHeight"]/
                    AbsoluteCurrentValue[Magnification]}]], 
                    "RGBColor[0.880722, 0.611041, 0.142051]"], Appearance -> 
                    None, BaseStyle -> {}, BaselinePosition -> Baseline, 
                    DefaultBaseStyle -> {}, ButtonFunction :> 
                    With[{Typeset`box$ = EvaluationBox[]}, 
                    If[
                    Not[
                    AbsoluteCurrentValue["Deployed"]], 
                    SelectionMove[Typeset`box$, All, Expression]; 
                    FrontEnd`Private`$ColorSelectorInitialAlpha = 1; 
                    FrontEnd`Private`$ColorSelectorInitialColor = 
                    RGBColor[0.880722, 0.611041, 0.142051]; 
                    FrontEnd`Private`$ColorSelectorUseMakeBoxes = True; 
                    MathLink`CallFrontEnd[
                    FrontEnd`AttachCell[Typeset`box$, 
                    FrontEndResource["RGBColorValueSelector"], {
                    0, {Left, Bottom}}, {Left, Top}, 
                    "ClosingActions" -> {
                    "SelectionDeparture", "ParentChanged", 
                    "EvaluatorQuit"}]]]], BaseStyle -> Inherited, Evaluator -> 
                    Automatic, Method -> "Preemptive"], 
                    RGBColor[0.880722, 0.611041, 0.142051], Editable -> False,
                     Selectable -> False], ",", 
                   RowBox[{"AbsoluteThickness", "[", "1.6`", "]"}]}], "]"}]}],
              "}"}], ",", 
           RowBox[{"{", 
             RowBox[{#, ",", #2}], "}"}], ",", 
           RowBox[{"LegendMarkers", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}], ",", 
                 RowBox[{"{", 
                   RowBox[{"False", ",", "Automatic"}], "}"}]}], "}"}]}], ",", 
           RowBox[{"Joined", "\[Rule]", 
             RowBox[{"{", 
               RowBox[{"True", ",", "True"}], "}"}]}], ",", 
           RowBox[{"LabelStyle", "\[Rule]", 
             RowBox[{"{", "}"}]}], ",", 
           RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}]}], "]"}]& ), 
      Editable -> True], TraditionalForm], TraditionalForm]},
  "Legended",
  DisplayFunction->(GridBox[{{
      TagBox[
       ItemBox[
        PaneBox[
         TagBox[#, "SkipImageSizeLevel"], Alignment -> {Center, Baseline}, 
         BaselinePosition -> Baseline], DefaultBaseStyle -> "Labeled"], 
       "SkipImageSizeLevel"], 
      ItemBox[#2, DefaultBaseStyle -> "LabeledLabel"]}}, 
    GridBoxAlignment -> {"Columns" -> {{Center}}, "Rows" -> {{Center}}}, 
    AutoDelete -> False, GridBoxItemSize -> Automatic, 
    BaselinePosition -> {1, 1}]& ),
  Editable->True,
  InterpretationFunction->(RowBox[{"Legended", "[", 
     RowBox[{#, ",", 
       RowBox[{"Placed", "[", 
         RowBox[{#2, ",", "After"}], "]"}]}], "]"}]& )]], "Output",
 CellChangeTimes->{
  3.672038168913566*^9, 3.6720382643655577`*^9, {3.672038297675126*^9, 
   3.672038311768202*^9}, {3.672038412082477*^9, 3.6720384233274384`*^9}, 
   3.672039112218783*^9, 3.672040969807008*^9, 3.672041008996722*^9, {
   3.672046582235297*^9, 3.6720465938420143`*^9}}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.67204213098946*^9, 3.67204213235606*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Test Simulated Annealing on Large Problem Sizes", "Subsection",
 CellChangeTimes->{{3.6720421492970963`*^9, 3.6720421566615562`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"times", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"energies", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"solns", "=", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", 
  RowBox[{
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "testHamiltonian", ",", "tempTime", ",", "tempSoln", ",", 
       "tempEnergy"}], "}"}], ",", 
     RowBox[{
      RowBox[{"testHamiltonian", "=", 
       RowBox[{"RandomHamiltonian", "[", 
        RowBox[{"i", ",", "0", ",", "0"}], "]"}]}], ";", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
         RowBox[{"{", 
          RowBox[{"tempTime", ",", 
           RowBox[{"{", 
            RowBox[{"tempEnergy", ",", "tempSoln"}], "}"}]}], "}"}], "=", 
         RowBox[{"Timing", "[", 
          RowBox[{"NMinimize", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"testHamiltonian", ",", 
              RowBox[{"Constraints", "[", "i", "]"}]}], "}"}], ",", 
            RowBox[{"SpinVariables", "[", "i", "]"}]}], "]"}], "]"}]}], ",", 
        RowBox[{"times", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"times", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempTime"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"solns", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"solns", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempSoln"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"energies", "=", 
         RowBox[{"Append", "[", 
          RowBox[{"energies", ",", 
           RowBox[{"{", 
            RowBox[{"i", ",", "tempEnergy"}], "}"}]}], "]"}]}], ",", 
        RowBox[{"Print", "[", 
         RowBox[{
          RowBox[{"ToString", "[", "i", "]"}], "<>", 
          "\"\< Spin Run Complete\>\""}], "]"}]}], "}"}]}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"i", ",", "15", ",", "15"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.672042186362397*^9, 3.672042331914823*^9}, {
  3.6720424224819813`*^9, 3.672042424304863*^9}, {3.672044733709538*^9, 
  3.6720447355288754`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["\<\"3 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.67204231823488*^9, 3.672042350483625*^9}],

Cell[BoxData["\<\"4 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.67204231823488*^9, 3.672042350519803*^9}],

Cell[BoxData["\<\"5 Spin Run Complete\"\>"], "Print",
 CellChangeTimes->{3.67204231823488*^9, 3.672042350595093*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{"times", "\[IndentingNewLine]", "energies", \
"\[IndentingNewLine]", "solns"}], "Input",
 CellChangeTimes->{{3.672042352764847*^9, 3.672042365464384*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", "0.015812`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", "0.035957`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", "0.074337`"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.672042353540951*^9, 3.672042365945045*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"-", "2.5025553832711265`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"-", "2.1607540675606183`"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"-", "4.314995787851492`"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.672042353540951*^9, 3.6720423659492064`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"3", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s2", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"4", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", "1.`"}]}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"5", ",", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"s1", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s2", "\[Rule]", "1.`"}], ",", 
       RowBox[{"s3", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s4", "\[Rule]", 
        RowBox[{"-", "1.`"}]}], ",", 
       RowBox[{"s5", "\[Rule]", "1.`"}]}], "}"}]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.672042353540951*^9, 3.67204236595541*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1301, 744},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (October 9, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 135, 1, 93, "Title"],
Cell[718, 25, 525, 9, 32, "Input"],
Cell[CellGroupData[{
Cell[1268, 38, 913, 16, 32, "Input"],
Cell[2184, 56, 1179, 30, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3400, 91, 1241, 22, 32, "Input"],
Cell[4644, 115, 1305, 26, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5986, 146, 119, 1, 45, "Subsection"],
Cell[6108, 149, 1502, 32, 77, "Input"],
Cell[CellGroupData[{
Cell[7635, 185, 251, 5, 55, "Input"],
Cell[7889, 192, 850, 28, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[8788, 226, 139, 1, 37, "Subsection"],
Cell[8930, 229, 460, 11, 55, "Input"],
Cell[9393, 242, 424, 8, 55, "Input"],
Cell[9820, 252, 1244, 31, 55, "Input"],
Cell[CellGroupData[{
Cell[11089, 287, 278, 6, 55, "Input"],
Cell[11370, 295, 658, 14, 70, "Output"]
}, Open  ]],
Cell[12043, 312, 527, 9, 55, "Input"],
Cell[12573, 323, 1913, 52, 99, "Input"],
Cell[CellGroupData[{
Cell[14511, 379, 373, 7, 55, "Input"],
Cell[14887, 388, 1782, 28, 70, "Output"]
}, Open  ]],
Cell[16684, 419, 1009, 21, 99, "Input"],
Cell[CellGroupData[{
Cell[17718, 444, 168, 3, 32, "Input"],
Cell[17889, 449, 358, 8, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[18296, 463, 170, 2, 37, "Subsection"],
Cell[18469, 467, 226, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[18720, 476, 133, 2, 32, "Input"],
Cell[18856, 480, 262, 6, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[19167, 492, 143, 1, 37, "Subsection"],
Cell[19313, 495, 3177, 83, 209, "Input"],
Cell[CellGroupData[{
Cell[22515, 582, 413, 10, 77, "Input"],
Cell[22931, 594, 233, 5, 32, "Output"],
Cell[23167, 601, 1331, 30, 148, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[24547, 637, 125, 1, 37, "Subsection"],
Cell[CellGroupData[{
Cell[24697, 642, 1326, 35, 121, "Input"],
Cell[26026, 679, 473, 13, 32, "Output"],
Cell[26502, 694, 475, 13, 32, "Output"]
}, Closed]],
Cell[CellGroupData[{
Cell[27014, 712, 4388, 106, 313, "Input"],
Cell[CellGroupData[{
Cell[31427, 822, 121, 1, 23, "Print"],
Cell[31551, 825, 119, 1, 23, "Print"],
Cell[31673, 828, 121, 1, 23, "Print"],
Cell[31797, 831, 119, 1, 23, "Print"],
Cell[31919, 834, 119, 1, 23, "Print"],
Cell[32041, 837, 119, 1, 23, "Print"],
Cell[32163, 840, 118, 1, 23, "Print"],
Cell[32284, 843, 120, 1, 23, "Print"],
Cell[32407, 846, 122, 1, 23, "Print"],
Cell[32532, 849, 122, 1, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[32703, 856, 182, 2, 77, "Input"],
Cell[32888, 860, 966, 26, 55, "Output"],
Cell[33857, 888, 5610, 157, 165, "Output"],
Cell[39470, 1047, 1269, 36, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40776, 1088, 188, 2, 77, "Input"],
Cell[40967, 1092, 890, 25, 55, "Output"],
Cell[41860, 1119, 5531, 156, 165, "Output"],
Cell[47394, 1277, 1190, 35, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48621, 1317, 1136, 25, 55, "Input"],
Cell[49760, 1344, 11552, 234, 434, "Output"]
}, Open  ]],
Cell[61327, 1581, 90, 1, 32, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[61454, 1587, 139, 1, 45, "Subsection"],
Cell[CellGroupData[{
Cell[61618, 1592, 2195, 59, 165, "Input"],
Cell[CellGroupData[{
Cell[63838, 1655, 116, 1, 23, "Print"],
Cell[63957, 1658, 116, 1, 23, "Print"],
Cell[64076, 1661, 116, 1, 23, "Print"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[64241, 1668, 168, 2, 77, "Input"],
Cell[64412, 1672, 320, 9, 32, "Output"],
Cell[64735, 1683, 414, 12, 32, "Output"],
Cell[65152, 1697, 1104, 34, 32, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
